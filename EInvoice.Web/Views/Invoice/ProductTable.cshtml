@model IEnumerable<EInvoice.Web.Models.ProductViewModel>
@using EInvoice.Web.Controllers.CategoryController
@using Unit = System.Web.UI.WebControls.Unit
@{
	var controller = ViewContext.Controller as CategoryController;
}
@{
	Html.EnableClientValidation();
	Html.EnableUnobtrusiveJavaScript();
}

@Html.DevExpress().GridView(settings => {
	settings.Name = "gridView";
	settings.KeyFieldName = "ProductID";
	settings.Width = Unit.Percentage(100);
	settings.CallbackRouteValues = new { Controller = "Invoice", Action = "GetByInvoiceID" };
	settings.SettingsEditing.BatchUpdateRouteValues = new { Controller = "Editing", Action = "UpdateInvoice" };

	settings.SettingsEditing.Mode = GridViewEditingMode.Batch;
	settings.SettingsEditing.BatchEditSettings.EditMode = GridViewBatchEditMode.Cell;
	settings.SettingsEditing.BatchEditSettings.StartEditAction = GridViewBatchStartEditAction.FocusedCellClick;
	settings.SettingsEditing.BatchEditSettings.HighlightDeletedRows = true;

	settings.CommandColumn.Visible = true;
	settings.CommandColumn.ShowDeleteButton = true;
	settings.CommandColumn.ShowNewButtonInHeader = true;
	settings.CommandColumn.Width = Unit.Point(50);

	settings.Columns.Add(c =>
	{
		c.FieldName = "Code";
		c.Caption = "Product Code";
	});

	settings.Columns.Add(c => {
		c.FieldName = "Name";
		c.Caption = "Name Of Product, Service";
		c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
		c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
	});

	settings.Columns.Add(c =>
	{
		c.FieldName = "UnitID";
		c.Caption = "Unit";
		c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
		c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
		c.EditorProperties().ComboBox(p =>
		{
			p.TextField = "Name";
			p.ValueField = "ID";
			p.ValueType = typeof(int);
			p.BindList(controller.GetAllUnit());
		});
	});

	settings.Init = (sender, e) =>
	{
		var c = new GridViewDataColumn() { FieldName = "Quantity" };
		c.UnboundType = DevExpress.Data.UnboundColumnType.Integer;
		c.VisibleIndex = 4;
		c.Width = 50;	
		c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
		c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
		((MVCxGridView)sender).Columns.Add(c);
	};

	settings.Columns.Add(c => {
		c.FieldName = "Unit Price";
	});

	settings.Init = (sender, e) =>
	{
		var c = new GridViewDataColumn() { FieldName = "Amount" };
		c.UnboundType = DevExpress.Data.UnboundColumnType.Integer;
		c.VisibleIndex = 5;
		c.Width = 50;
		c.CellStyle.HorizontalAlign = HorizontalAlign.Center;
		c.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;
		((MVCxGridView)sender).Columns.Add(c);
	};

	settings.ClientSideEvents.BeginCallback = "OnBeginGridCallback";
}).Bind(Model).GetHtml()